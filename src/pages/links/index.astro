---
import { turso, type Link } from "../../utils/turso";
import Layout from "../../components/Layout.astro";
import { dateOptions } from "../../utils/types";

const { rows } = await turso().execute("SELECT * FROM links");
const links = rows as Link[];
console.log(links);
---

<Layout title="Links">
  <header class="lg:col-span-10 lg:col-start-3">
    <h1 class="text-4xl lg:text-6xl font-semibold text-balance">Links</h1>
    <p class="text-lg text-white/70 max-w-xl mt-4 leading-snug text-pretty">
      Links to things Iâ€™ve seen and liked around the web
    </p>
  </header>
  <ul class="lg:col-start-3 lg:col-span-11">
    {
      links.map((row) => (
        <li class="flex items-end gap-4 border-t border-white/20 last:border-b py-2 text-lg">
          <h2 class="font-bold shrink-0">
            <a href={row.url} class="underline underline-offset-2">
              {row.title}
            </a>
          </h2>
          <p class="text-white/70 truncate">
            <a href={row.url} class="underline underline-offset-2">
              {row.url}
            </a>
          </p>
          <p class="text-white/70 ml-auto shrink-0">
            {new Date(row.date).toLocaleDateString("en-GB", dateOptions)}
          </p>
        </li>
      ))
    }
  </ul>
</Layout>
